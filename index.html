<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Gems of Spotify</title>
        <meta name="description" content="Finding unpopular albums from Spotify">
        <!--<link rel="stylesheet" href="main.css"> -->
    </head>
    <body>
        <!--<iframe src="https://open.spotify.com/embed/album/3oNO1P0Qlr4oSlMA2MIj67" width="300" height="380" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe> -->
        <script>
            var express = require('express');
            var app = express();
            
            app.use(express.static('public'));
            
            app.get("/", function (request, response) {
                response.sendFile(__dirname);
            });
            
            var SpotifyWebApi = require('spotify-web-api-node');
            
            var spotifyApi = new SpotifyWebApi({
                clientId : process.env.CLIENT_ID,
                clientSecret : process.env.CLIENT_SECRET
            });
            
            spotifyApi.clientCredentialsGrant()
                .then(function(data) {
                      
                spotifyApi.setAccessToken(data.body['access_token']);
                
            }, function(err) {
                console.log('Something went wrong when retrieving an cess token', err.message);
            });
            
            app.get('/myendpoint', function (request, response) {
                
                spotifyApi.searchTracks('track:Dancing Queen', {limit:1})
                    .then(functioin(data) {
                    
                    response.send(data.body.tracks.items[0]);
                
            }, function(err) {
                console.error(err);
            });
            });
            /*
            const Url = 'https://accounts.spotify.com/api/token';
            
            const param = {
                headers:{
                    "Authorization": "Basic" + "c5d4762aefc2460ba0648363efbb0cd7:5323c99219f8448d845ffeb9b06bcde9"
                },
                body:{
                    "grant_type":"client_credentials"
                },
                method:"POST"
            };
                
            fetch(Url, param)
                .then(data=>{return data.json()})
                .then(res=>{console.log(res)})
                .catch(error=>console.log(error))
            
            fetch('https://api.spotify.com/v1/search?q=tag:hipster&type=album&limit=1', {
                headers: new Headers({
                    'Authorization': )
                .then(response => {console.log})
            
            const express = require('express')
            const axios = require('axios')
            const app = express()
            const port = 3000
            app.get('/gem', (req, res) => {
                let random = Math.floor(5000 * Math.random());
                let url = "https://api.spotify.com/v1/search?q=tag:hipster&type=album&limit=1&offset=" + random
                let token = "BQDMqbZtWavZdp3jY4pX6-fmdmkcJRGa_N67-Nl0tOJTCyhhWKAGovpoWHj7_pM-xzV3ZlUXZlZlC1ICfDvTVnqMSvn9lQZJhcNVX0ttANNw0K715bxn2Ymqwm7uF4oJPpF3LvG2z6icHmmqKijyaieMQhNYZBMOb42mKFS36vY"
                axios.get(url, {
                    headers: {
                        "Authorization": "Bearer " + token
                    }
                }).then((data) => {
                    console.log(data)
                    res.send(JSON.stringify(data.data));
                }).catch((e) => res.send(e));
            });

            app.listen(8080)
            */
        </script>
    </body>
</html>
